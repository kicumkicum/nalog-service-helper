<!DOCTYPE html>
<html>
	<head>
		<base target="_top">
		<script>
			(function(window) {
				window.onload = function() {
					const button = document.getElementById('button');
					button.addEventListener('click', function() {
						const input = document.getElementById('input');
						const inputValue = input.value;

						if (input) {
							const image = document.getElementById('image');
							const imageSrc = image.src;
							const mask = '&a=';
							const index = imageSrc.indexOf(mask);

							try {
								var captchaToken = imageSrc.substring(index + mask.length);
							} catch (e) {
								alert(e)
							}
							const captcha = {
								token: captchaToken,
								value: inputValue
							};
							try {
								google.script.run.setCaptcha(captcha);
							} catch (e) {
								alert('ERROR: ' + e)
							}
						}
					});
				}
			})(window)
		</script>
	</head>
	<body>
		<img id=image>
		<input id="input">
		<button id="button"></button>
	</body>
</html>


